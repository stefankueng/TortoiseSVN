<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=windows-1252">
	<TITLE>How to install an Apache-based Subversion server on Windows</TITLE>
	<META NAME="GENERATOR" CONTENT="OpenOffice.org 1.0.1  (Win32)">
	<META NAME="AUTHOR" CONTENT="Stefan K&uuml;ng">
	<META NAME="CREATED" CONTENT="20030603;8410000">
	<META NAME="CHANGEDBY" CONTENT="Stefan K&uuml;ng">
	<META NAME="CHANGED" CONTENT="20030614;19255868">
	<STYLE>
	<!--
		@page { margin-left: 2cm; margin-right: 2.5cm; margin-top: 2.5cm; margin-bottom: 2cm }
		TD P { color: #000000 }
		H1 { margin-bottom: 0.11cm; color: #000000; widows: 2; orphans: 2 }
		H1.western { font-family: "Arial", sans-serif; font-size: 16pt; so-language: de-CH }
		H1.cjk { font-family: "Times New Roman", serif; font-size: 16pt }
		H1.ctl { font-size: 12pt; font-weight: medium }
		P { color: #000000 }
		H2 { margin-bottom: 0.11cm; color: #000000; widows: 2; orphans: 2 }
		H2.western { font-family: "Arial", sans-serif; font-size: 14pt; so-language: de-CH; font-style: italic }
		H2.cjk { font-family: "Times New Roman", serif; font-size: 14pt; font-style: italic }
		H2.ctl { font-size: 12pt; font-weight: medium }
		A:link { color: #0000ff }
	-->
	</STYLE>
</HEAD>
<BODY LANG="de-DE" TEXT="#000000" LINK="#0000ff">
<H1 LANG="de-CH" CLASS="western">How to install an Apache-based
Subversion server on Windows</H1>
<P LANG="de-CH" STYLE="margin-bottom: 0cm">What you need:</P>
<OL>
	<LI><P LANG="de-CH" STYLE="margin-bottom: 0cm">Windows2000 or
	WindowsXP SP1 (Please note: WinXP without the SP1 won't work &ndash;
	you could end up with a corrupted repository! Also Apache is not
	tested for Win98)</P>
	<LI><P STYLE="margin-bottom: 0cm"><SPAN LANG="de-CH">The newest
	version of the apache2 server from
	<A HREF="http://httpd.apache.org/download.cgi">http://httpd.apache.org/download.cgi</A>,
	make sure you download the windows msi installer.</SPAN></P>
	<LI><P STYLE="margin-bottom: 0cm"><SPAN LANG="de-CH">The newest
	version of the Subversion binaries. You can get those from the
	<A HREF="http://subversion.tigris.org/servlets/ProjectDocumentList?folderID=91">filesharing
	area</A> on the <A HREF="http://subversion.tigris.org/">Subversion
	website</A></SPAN></P>
</OL>
<H2 LANG="de-CH" CLASS="western">Installation</H2>
<P LANG="de-CH" STYLE="margin-bottom: 0cm">Now that you have all
required binaries you're ready to install and configure the
Subversion server:</P>
<UL>
	<LI><P LANG="de-CH" STYLE="margin-bottom: 0cm">First install the
	Apache webserver. Doubleclick on the msi file and follow the
	instructions of the setup program. Please make sure you enter the
	server-URL correctly (if you don't have a dns name for your server
	just enter the ip-address). I recommend to install apache &bdquo;for
	all users, on port 80, as a service&ldquo;.</P>
	<LI><P LANG="de-CH" STYLE="margin-bottom: 0cm">Now test if the
	Apache-webserver is running correctly by pointing your webbrowser to
	http://localhost/ - a preconfigured Website should show up.</P>
	<LI><P LANG="de-CH" STYLE="margin-bottom: 0cm">Run the Subversion
	setup program and follow the instructions.</P>
	<LI><P LANG="de-CH" STYLE="margin-bottom: 0cm">Open the
	windows-explorer, go to the installation directory of Subversion
	(usually c:\program files\Subversion) and find the files
	/Apache2/modules/mod_dav_svn.so and mod_authz_svn.so &ndash; copy
	these files to the Apache modules directory (usually c:\program
	files\apache group\apache2\modules)</P>
	<LI><P LANG="de-CH" STYLE="margin-bottom: 0cm">Copy the files
	libdb40.dll, libeay32.dll and ssleay32.dll from the Subversion
	installation directory to the apache modules directory.</P>
</UL>
<H2 LANG="de-CH" CLASS="western">Configuration</H2>
<P LANG="de-CH" STYLE="margin-bottom: 0cm">To get Apache to know
which URL shall be used for Subversion repositories you have to edit
the Apache config file (usually located in c:\program files\apache
group\apache2\conf\httpd.conf) with any text editor you like (e.g.
Notepad):</P>
<UL>
	<LI><P LANG="de-CH" STYLE="margin-bottom: 0cm">If you don't have
	created a Subversion repository it's time to do that now. I'd
	recommend to create an empty folder with the name SVN (e.g.D:\SVN).
	Open the command prompt (or DOS-Box), change into the just created
	folder and type<BR><FONT FACE="Courier New, monospace">svnadmin
	create &lt;projectname&gt;</FONT><BR>where <FONT FACE="Courier New, monospace">projectname<I>
	</I></FONT>should be the name the project you want under version
	control. If you have multiple projects repeat the command.</P>
	<LI><P LANG="de-CH" STYLE="margin-bottom: 0cm">Open the config file
	and find the lines<BR><FONT FACE="Courier New, monospace">#LoadModule
	dav_module modules/mod_dav.so<BR>#LoadModule dav_fs_module
	modules/mod_dav_fs.so<BR></FONT>and <FONT FACE="Times New Roman, serif">remove
	the comment sign '#'.</FONT></P>
	<LI><P LANG="de-CH" STYLE="margin-bottom: 0cm"><FONT FACE="Times New Roman, serif">At
	the end of all those LoadModule lines add the line<BR><FONT FACE="Courier New, monospace">LoadModule
	dav_svn_module modules/mod_dav_svn.so<BR>LoadModule authz_svn_module
	modules/mod_authz_svn.so</FONT></FONT></P>
	<LI><P LANG="de-CH" STYLE="margin-bottom: 0cm"><FONT FACE="Times New Roman, serif">Restart
	the apache service.</FONT></P>
	<LI><P LANG="de-CH" STYLE="margin-bottom: 0cm"><FONT FACE="Times New Roman, serif">At
	the end of the Config file add the following lines:<FONT FACE="Courier New, monospace"><BR>&lt;Location
	/svn/&gt;<BR>DAV svn<BR>SVNParentPath d:\SVN\<BR>AuthType
	Basic<BR>AuthName &quot;Subversion repositories&quot;<BR>AuthUserFile
	passwd<BR>#AuthzSVNAccessFile svnaccessfile<BR>Require
	valid-user<BR>&lt;/Location&gt;</FONT></FONT></P>
	<LI><P LANG="de-CH" STYLE="margin-bottom: 0cm"><FONT FACE="Times New Roman, serif">A
	short explanation of what you just entered:</FONT></P>
	<TABLE WIDTH=100% BORDER=1 CELLPADDING=2 CELLSPACING=3>
		<COL WIDTH=86*>
		<COL WIDTH=170*>
		<THEAD>
			<TR>
				<TD WIDTH=34% BGCOLOR="#ccccff">
					<P LANG="de-CH"><FONT FACE="Courier New, monospace">&lt;Location
					/svn/&gt;</FONT></P>
				</TD>
				<TD WIDTH=66% BGCOLOR="#ccccff">
					<P LANG="de-CH"><FONT FACE="Times New Roman, serif">means that
					the Subversion repositories are available from the URL
					http://server/svn/</FONT></P>
				</TD>
			</TR>
		</THEAD>
		<TBODY>
			<TR>
				<TD WIDTH=34% BGCOLOR="#ccccff">
					<P LANG="de-CH"><FONT FACE="Courier New, monospace">DAV svn</FONT></P>
				</TD>
				<TD WIDTH=66% BGCOLOR="#ccccff">
					<P LANG="de-CH"><FONT FACE="Times New Roman, serif">tells Apache
					which module will be responsible to serve that URL &ndash; in
					this case the Subversion module.</FONT></P>
				</TD>
			</TR>
			<TR>
				<TD WIDTH=34% BGCOLOR="#ccccff">
					<P LANG="de-CH"><FONT FACE="Courier New, monospace">SVNParentPath
					d:\SVN\</FONT></P>
				</TD>
				<TD WIDTH=66% BGCOLOR="#ccccff">
					<P LANG="de-CH"><FONT FACE="Times New Roman, serif">tells
					Subversion where to find the repositories</FONT></P>
				</TD>
			</TR>
			<TR>
				<TD WIDTH=34% BGCOLOR="#ccccff">
					<P LANG="de-CH"><FONT FACE="Courier New, monospace">AuthType
					Basic</FONT></P>
				</TD>
				<TD WIDTH=66% BGCOLOR="#ccccff">
					<P LANG="de-CH"><FONT FACE="Times New Roman, serif">is to
					activate basic authentication, i.e. Username/password</FONT></P>
				</TD>
			</TR>
			<TR>
				<TD WIDTH=34% BGCOLOR="#ccccff">
					<P LANG="de-CH"><FONT FACE="Courier New, monospace">AuthName
					&quot;Subversion repositories&quot;</FONT></P>
				</TD>
				<TD WIDTH=66% BGCOLOR="#ccccff">
					<P LANG="de-CH"><FONT FACE="Times New Roman, serif">is used as
					an information whenever an authentication dialog pops up to tell
					the user what the authentication is for</FONT></P>
				</TD>
			</TR>
			<TR>
				<TD WIDTH=34% BGCOLOR="#ccccff">
					<P LANG="de-CH"><FONT FACE="Courier New, monospace">AuthUserFile
					passwd</FONT></P>
				</TD>
				<TD WIDTH=66% BGCOLOR="#ccccff">
					<P LANG="de-CH"><FONT FACE="Times New Roman, serif">specifies
					which password file to use for authentication</FONT></P>
				</TD>
			</TR>
			<TR>
				<TD WIDTH=34% BGCOLOR="#ccccff">
					<P LANG="de-CH"><FONT FACE="Courier New, monospace">AuthzSVNAccessFile</FONT></P>
				</TD>
				<TD WIDTH=66% BGCOLOR="#ccccff">
					<P LANG="de-CH"><FONT FACE="Times New Roman, serif">Location of
					the Access file for paths inside a subversion repository</FONT></P>
				</TD>
			</TR>
			<TR>
				<TD WIDTH=34% BGCOLOR="#ccccff">
					<P LANG="de-CH"><FONT FACE="Courier New, monospace">Require
					valid-user</FONT></P>
				</TD>
				<TD WIDTH=66% BGCOLOR="#ccccff">
					<P LANG="de-CH"><FONT FACE="Times New Roman, serif">specifies
					that only users who entered a correct username/password are
					allowed to access the URL </FONT>
					</P>
				</TD>
			</TR>
		</TBODY>
	</TABLE>
	<LI><P LANG="de-CH" STYLE="margin-bottom: 0cm"><FONT FACE="Times New Roman, serif">If
	you want your repository to have read access for everyone but write
	access only for specific users you can change the line<BR><FONT FACE="Courier New, monospace">Require
	valid-user<BR><FONT FACE="Times New Roman, serif">to</FONT><BR>&lt;LimitExcept
	GET PROPFIND OPTIONS REPORT&gt;<BR>Require valid-user<BR>&lt;/LimitExcept&gt;</FONT></FONT></P>
	<LI><P LANG="de-CH" STYLE="margin-bottom: 0cm"><FONT FACE="Times New Roman, serif">If
	you want to give users access only for specific folders inside a
	repository you have to uncomment the line<BR><FONT FACE="Courier New, monospace">#AuthzSVNAccessFile
	svnaccessfile</FONT><BR>and create a Subversion access file. An
	example file would look like this:<BR><FONT FACE="Courier New, monospace">#[groups]<BR>developers
	= user1,user2,user3,user4<BR>docs = user5,user6,user7<BR><BR>#to
	allow everyone read access<BR>[/]<BR>* = r<BR><BR>#allow all
	developers complete access<BR>@developers = rw<BR><BR>#give the doc
	people write access to the docs folder<BR>[/project/trunk/doc]<BR>@docs
	= rw</FONT></FONT></P>
	<LI><P LANG="de-CH" STYLE="margin-bottom: 0cm"><FONT FACE="Times New Roman, serif">Open
	again the command prompt (DOS-Box), change to the apache2 folder
	(usually c:\program files\apache group\apache2) and create a
	password file by entering<BR><FONT FACE="Courier New, monospace">bin\htpasswd
	&ndash;c passwd &lt;username</FONT>&gt;<BR>This will create a file
	with the name passwd which is used for authentication. Additional
	users can be added with<BR><FONT FACE="Courier New, monospace">bin\htpasswd
	passwd &lt;username&gt;</FONT></FONT></P>
	<LI><P LANG="de-CH" STYLE="margin-bottom: 0cm"><FONT FACE="Times New Roman, serif">Restart
	the apache service again.</FONT></P>
	<LI><P LANG="de-CH" STYLE="margin-bottom: 0cm"><FONT FACE="Times New Roman, serif">Point
	your browser to http://servername/svn/projectname (where projectname
	is the name of your Subversion repository you created before). If
	all went well you should be prompted for a username and password,
	then you can see the contents of your repository.</FONT></P>
</UL>
<P LANG="de-CH" STYLE="margin-bottom: 0cm"><FONT FACE="Times New Roman, serif"><BR><B><FONT COLOR="#b80047">Congratulations!
You have successfully set up your Subversion server!</FONT></B></FONT></P>
<H2 LANG="de-CH" CLASS="western">Authentication with Windows-Domain</H2>
<P LANG="de-CH" STYLE="margin-bottom: 0cm">As you might have noticed
you need to make a username/password entry in the passwd file for
each user separately. And if (for security reasons) you want your
users to change the password from time to time you have to change
that each time manually.</P>
<P LANG="de-CH" STYLE="margin-bottom: 0cm">But there's a solution for
that problem &ndash; at least if you're accessing the repository from
inside a LAN with a windows domain controller: mod_auth_sspi</P>
<P STYLE="margin-bottom: 0cm"><SPAN LANG="de-CH">You can get this
apache authentication module from <A HREF="http://www.syneapps.com/software/mod_auth_sspi/">syneapps</A>
for free. </SPAN>
</P>
<UL>
	<LI><P LANG="de-CH" STYLE="margin-bottom: 0cm">Download the module,
	place the file mod_auth_sspi.so in the apache modules folder</P>
	<LI><P LANG="de-CH" STYLE="margin-bottom: 0cm">edit the apache
	config file: add the line<BR><FONT FACE="Courier New, monospace">LoadModule
	sspi_auth_module modules/mod_auth_sspi.so<BR></FONT><FONT FACE="Times New Roman, serif">to
	the LoadModule's section. Make sure you insert this line before the
	line <BR></FONT><FONT FACE="Courier New, monospace">LoadModule
	auth_module modules/mod_auth.so</FONT></P>
	<LI><P LANG="de-CH" STYLE="margin-bottom: 0cm"><FONT FACE="Times New Roman, serif">To
	make the Subversion location use this type of authentication you
	have to change the line<BR><FONT FACE="Courier New, monospace">AuthType
	Basic <BR><FONT FACE="Times New Roman, serif">to</FONT><BR>AuthType
	SSPI</FONT><BR>also you need to add <BR><FONT FACE="Courier New, monospace">SSPIAuth
	On<BR>SSPIAuthoritative On<BR>SSPIDomain &lt;domaincontroller&gt;</FONT><BR>if
	you don't specify a domaincontroller then it assumes that the local
	server is also the domain controller.</FONT></P>
</UL>
<H2 LANG="de-CH" CLASS="western">Securing the server with SSL</H2>
<P LANG="de-CH" STYLE="margin-bottom: 0cm"><FONT FACE="Times New Roman, serif">The
apache server doesn't have SSL support installed by default due to
US-export restrictions. But you can easily download the required
module from somewhere else and install it yourself.</FONT></P>
<UL>
	<LI><P STYLE="margin-bottom: 0cm"><SPAN LANG="de-CH"><FONT FACE="Times New Roman, serif">First
	you need the required files to enable SSL. You can find those in the
	package available <A HREF="http://hunter.campbus.com/">here</A>.
	Just unzip the package and then copy mod_ssl.so to the modules
	folder of Apache and the file openssl.exe to the bin folder. Also
	copy the file conf/ssl.conf to the conf folder of Apache.</FONT></SPAN></P>
	<LI><P LANG="de-CH" STYLE="margin-bottom: 0cm"><FONT FACE="Times New Roman, serif">Open
	the file ssl.conf in the Apache conf folder with a text editor.</FONT></P>
	<LI><P LANG="de-CH" STYLE="margin-bottom: 0cm"><FONT FACE="Times New Roman, serif">Place
	a comment char (#) in front of the following lines:<BR><FONT FACE="Courier New, monospace">DocumentRoot
	&quot;c:/apache/htdocs&quot;<BR>ServerName
	new.host.name:443<BR>ServerAdmin <SPAN STYLE="text-decoration: none"><FONT COLOR="#000000">you@your.address</FONT></SPAN><BR>ErrorLog
	logs/error_log<BR>TransferLog logs/access_log </FONT></FONT>
	</P>
	<LI><P LANG="de-CH" STYLE="margin-bottom: 0cm"><FONT FACE="Courier New, monospace"><FONT FACE="Times New Roman, serif">change
	the line</FONT><BR><SPAN LANG="en-GB">SSLCertificateFile
	c:/apache/conf/ssl.crt/server.crt<BR><FONT FACE="Times New Roman, serif">to</FONT><BR>SSLCertificateFile
	conf/ssl/my-server.cert<BR><FONT FACE="Times New Roman, serif">and
	the line</FONT><BR>SSLCertificateKeyFile
	c:/apache/conf/ssl.key/server.key<BR><FONT FACE="Times New Roman, serif">to</FONT><BR>SSLCertificateKeyFile
	conf/ssl/my-server.key</SPAN></FONT></P>
	<LI><P LANG="en-GB" STYLE="margin-bottom: 0cm"><FONT FACE="Courier New, monospace"><FONT FACE="Times New Roman, serif">Delete
	the lines</FONT><BR>&lt;IfDefine SSL&gt; <BR><FONT FACE="Times New Roman, serif">and</FONT><BR>&lt;/IfDefine&gt;</FONT></P>
	<LI><P LANG="en-GB" STYLE="margin-bottom: 0cm"><FONT FACE="Times New Roman, serif">Open
	the Apache config file (httpd.conf) and uncomment the
	line<BR><FONT FACE="Courier New, monospace">#LoadModule ssl_module
	modules/mod_ssl.so</FONT></FONT></P>
	<LI><P STYLE="margin-bottom: 0cm"><SPAN LANG="en-GB"><FONT FACE="Times New Roman, serif">Openssl
	needs a config file. You can download a working one from <A HREF="http://tud.at/programm/openssl.cnf">here</A>.
	Please note: the file has the type *.cnf. Windows treats such files
	in a special way but it really is just a text file!</FONT></SPAN></P>
	<LI><P LANG="de-CH" STYLE="margin-bottom: 0cm"><SPAN LANG="en-GB"><FONT FACE="Times New Roman, serif">Next
	you need to create an SSL certificate. To do that open a command
	prompt (DOS-Box) and change to the apache folder (e.g. C:\program
	files\apache group\apache2) and type the following
	command:<BR></FONT></SPAN><FONT FACE="Courier New, monospace">bin\openssl
	req &ndash;config bin\openssl.cnf &ndash;new &ndash;out
	my-server.csr<BR></FONT>You will ber asked for a passphrase. Please
	don't use simple words but whole sentences, e.g. a part of a poem.
	The longer the phrase the better.<BR>Also you have to enter the URL
	of you server. All other questions are optional but I recommend to
	fill out those too. Next type the commands<BR><SPAN LANG="en-GB"><FONT FACE="Courier New, monospace">bin\openssl
	rsa &ndash;in privkey.pem &ndash;out my-server.key</FONT></SPAN><BR>and<BR><SPAN LANG="en-GB"><FONT FACE="Courier New, monospace">bin\openssl
	x509 &ndash;in my-server.csr &ndash;out my-server.cert &ndash;req
	&ndash;signkey my-server.key &ndash;days 4000</FONT></SPAN><BR>This
	will create a certificate which will expire in 4000 days.<BR>And
	finally enter:<BR><SPAN LANG="en-GB"><FONT FACE="Courier New, monospace">bin\openssl
	x509 &ndash;in my-server.cert &ndash;out my-server.der.crt &ndash;outform
	DER</FONT></SPAN><BR>These commands created some files in the apache
	folder. Copy the files and to the folder conf/ssl (e.g. C:\program
	files\apache group\apache2\conf\ssl) &ndash; if this folder does not
	exist you have to create it first.</P>
	<LI><P LANG="de-CH" STYLE="margin-bottom: 0cm">Restart the apache
	service.</P>
	<LI><P LANG="de-CH" STYLE="margin-bottom: 0cm">Point your browser to
	https://servername/svn/project ....</P>
</UL>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
</BODY>
</HTML>