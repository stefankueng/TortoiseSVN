(function(){var t,e,i;t=jQuery,i=function(){function t(){this.fileLoadingImage="../img/loading.gif",this.fileCloseImage="../img/close.png",this.resizeDuration=700,this.fadeDuration=500,this.labelImage="Image",this.labelOf="of"}return t}(),e=function(){function e(t){this.options=t,this.album=[],this.currentImageIndex=void 0,this.init()}return e.prototype.init=function(){return this.enable(),this.build()},e.prototype.enable=function(){var e=this;return t("body").on("click","a[rel^=lightbox], area[rel^=lightbox]",function(i){return e.start(t(i.currentTarget)),!1})},e.prototype.build=function(){var e,i=this;t("<div>",{id:"lightboxOverlay"}).after(t("<div/>",{id:"lightbox"}).append(t("<div/>",{"class":"lb-outerContainer"}).append(t("<div/>",{"class":"lb-container"}).append(t("<img/>",{"class":"lb-image"}),t("<div/>",{"class":"lb-nav"}).append(t("<a/>",{"class":"lb-prev"}),t("<a/>",{"class":"lb-next"})),t("<div/>",{"class":"lb-loader"}).append(t("<a/>",{"class":"lb-cancel"}).append(t("<img/>",{src:this.options.fileLoadingImage}))))),t("<div/>",{"class":"lb-dataContainer"}).append(t("<div/>",{"class":"lb-data"}).append(t("<div/>",{"class":"lb-details"}).append(t("<span/>",{"class":"lb-caption"}),t("<span/>",{"class":"lb-number"})),t("<div/>",{"class":"lb-closeContainer"}).append(t("<a/>",{"class":"lb-close"}).append(t("<img/>",{src:this.options.fileCloseImage}))))))).appendTo(t("body")),t("#lightboxOverlay").hide().on("click",function(){return i.end(),!1}),e=t("#lightbox"),e.hide().on("click",function(e){return"lightbox"===t(e.target).attr("id")&&i.end(),!1}),e.find(".lb-outerContainer").on("click",function(e){return"lightbox"===t(e.target).attr("id")&&i.end(),!1}),e.find(".lb-prev").on("click",function(){return i.changeImage(i.currentImageIndex-1),!1}),e.find(".lb-next").on("click",function(){return i.changeImage(i.currentImageIndex+1),!1}),e.find(".lb-loader, .lb-close").on("click",function(){return i.end(),!1})},e.prototype.start=function(e){var i,n,a,o,r,s,l,h,d;if(t(window).on("resize",this.sizeOverlay),t("select, object, embed").css({visibility:"hidden"}),t("#lightboxOverlay").width(t(document).width()).height(t(document).height()).fadeIn(this.options.fadeDuration),this.album=[],r=0,"lightbox"===e.attr("rel"))this.album.push({link:e.attr("href"),title:e.attr("title")});else for(d=t(e.prop("tagName")+'[rel="'+e.attr("rel")+'"]'),o=0,h=d.length;h>o;o++)a=d[o],this.album.push({link:t(a).attr("href"),title:t(a).attr("title")}),t(a).attr("href")===e.attr("href")&&(r=o);n=t(window),l=n.scrollTop()+n.height()/10,s=n.scrollLeft(),i=t("#lightbox"),i.css({top:l+"px",left:s+"px"}).fadeIn(this.options.fadeDuration),this.changeImage(r)},e.prototype.changeImage=function(e){var i,n,a,o=this;this.disableKeyboardNav(),n=t("#lightbox"),i=n.find(".lb-image"),this.sizeOverlay(),t("#lightboxOverlay").fadeIn(this.options.fadeDuration),t(".loader").fadeIn("slow"),n.find(".lb-image, .lb-nav, .lb-prev, .lb-next, .lb-dataContainer, .lb-numbers, .lb-caption").hide(),n.find(".lb-outerContainer").addClass("animating"),a=new Image,a.onload=function(){return i.attr("src",o.album[e].link),i.width=a.width,i.height=a.height,o.sizeContainer(a.width,a.height)},a.src=this.album[e].link,this.currentImageIndex=e},e.prototype.sizeOverlay=function(){return t("#lightboxOverlay").width(t(document).width()).height(t(document).height())},e.prototype.sizeContainer=function(e,i){var n,a,o,r,s,l,h,d,c,u,b,g=this;a=t("#lightbox"),o=a.find(".lb-outerContainer"),b=o.outerWidth(),u=o.outerHeight(),n=a.find(".lb-container"),h=parseInt(n.css("padding-top"),10),l=parseInt(n.css("padding-right"),10),r=parseInt(n.css("padding-bottom"),10),s=parseInt(n.css("padding-left"),10),c=e+s+l,d=i+h+r,c!==b&&d!==u?o.animate({width:c,height:d},this.options.resizeDuration,"swing"):c!==b?o.animate({width:c},this.options.resizeDuration,"swing"):d!==u&&o.animate({height:d},this.options.resizeDuration,"swing"),setTimeout(function(){a.find(".lb-dataContainer").width(c),a.find(".lb-prevLink").height(d),a.find(".lb-nextLink").height(d),g.showImage()},this.options.resizeDuration)},e.prototype.showImage=function(){var e;e=t("#lightbox"),e.find(".lb-loader").hide(),e.find(".lb-image").fadeIn("slow"),this.updateNav(),this.updateDetails(),this.preloadNeighboringImages(),this.enableKeyboardNav()},e.prototype.updateNav=function(){var e;e=t("#lightbox"),e.find(".lb-nav").show(),this.currentImageIndex>0&&e.find(".lb-prev").show(),this.currentImageIndex<this.album.length-1&&e.find(".lb-next").show()},e.prototype.updateDetails=function(){var e,i=this;e=t("#lightbox"),this.album[this.currentImageIndex].title!==void 0&&""!==this.album[this.currentImageIndex].title&&e.find(".lb-caption").html(this.album[this.currentImageIndex].title).fadeIn("fast"),this.album.length>1?e.find(".lb-number").html(this.options.labelImage+" "+(this.currentImageIndex+1)+" "+this.options.labelOf+"  "+this.album.length).fadeIn("fast"):e.find(".lb-number").hide(),e.find(".lb-outerContainer").removeClass("animating"),e.find(".lb-dataContainer").fadeIn(this.resizeDuration,function(){return i.sizeOverlay()})},e.prototype.preloadNeighboringImages=function(){var t,e;this.album.length>this.currentImageIndex+1&&(t=new Image,t.src=this.album[this.currentImageIndex+1].link),this.currentImageIndex>0&&(e=new Image,e.src=this.album[this.currentImageIndex-1].link)},e.prototype.enableKeyboardNav=function(){t(document).on("keyup.keyboard",t.proxy(this.keyboardAction,this))},e.prototype.disableKeyboardNav=function(){t(document).off(".keyboard")},e.prototype.keyboardAction=function(t){var e,i,n,a,o;e=27,i=37,n=39,o=t.keyCode,a=String.fromCharCode(o).toLowerCase(),o===e||a.match(/x|o|c/)?this.end():"p"===a||o===i?0!==this.currentImageIndex&&this.changeImage(this.currentImageIndex-1):("n"===a||o===n)&&this.currentImageIndex!==this.album.length-1&&this.changeImage(this.currentImageIndex+1)},e.prototype.end=function(){return this.disableKeyboardNav(),t(window).off("resize",this.sizeOverlay),t("#lightbox").fadeOut(this.options.fadeDuration),t("#lightboxOverlay").fadeOut(this.options.fadeDuration),t("select, object, embed").css({visibility:"visible"})},e}(),t(function(){var t,n;return n=new i,t=new e(n)})}).call(this);